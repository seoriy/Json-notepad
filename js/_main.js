!function(){"use strict";function e(e){var n=JSON.stringify(e);return n}function n(){return{isSimpleField:function(e){return angular.isString(e)||angular.isNumber(e)||angular.isDate(e)},isStringField:function(e){return angular.isString(e)},isNumberField:function(e){return angular.isNumber(e)},isDateField:function(e){return angular.isDate(e)},isArrayField:function(e){return angular.isArray(e)},isObjectField:function(e){return!angular.isArray(e)&&angular.isObject(e)},isLabelDefined:function(e){return 0==e||e},isLink:function(e){return angular.isString(e)&&(0===e.trim().indexOf("http://")||0===e.trim().indexOf("https://"))}}}function t(){return[{name:"",descr:"<None>"},{name:"colors",descr:"colors"},{name:"customer",descr:"customer"},{name:"facebook",descr:"facebook"},{name:"flikr",descr:"flikr"},{name:"google-maps",descr:"google-maps"},{name:"iphone",descr:"iphone"},{name:"microsoft",descr:"microsoft"},{name:"twitter",descr:"twitter"},{name:"youtube",descr:"youtube"}]}function r(){return{restrict:"AE",scope:{},link:function(e,n,t){n.on("click",function(){alert("del field"),$(n).parentsUntil("div.row-container").find("field").toggle()})}}}function i(e,n){n.apply(function(){var n=function(n){$("div.label-"+n).hover(function(){alert(this),$(this).append("<div ng-include=\"'parts/toolbar-label-"+n+".html\"'"),e($(this))},function(){$(this).remove(".toolbar"),e($(this))})};n("obj"),n("array")})}function a(n,t,r,a,o,s,u,l){function c(){n.toJson=e,n.targetObj||(n.targetObj=n.sample),n.editScope={editingField:"",editingItemIndex:-1,editValue:""}}n.samples=l,n.fieldService=u,c(),n.jsonText=JSON.stringify(n.targetObj),n.loadSample=function(e){e&&""!=e&&("<None>"==n.sampleName?(n.jsonText="{}",n.parseObject()):t.get("data/samples/sample-"+e+".json",{transformResponse:[]}).then(function(t){n.jsonText=t.data,n.parseObject(),s.eventTrack("loadSample",{category:"samples",label:e})}))},n.iterateObj=function(e){var n=[];return angular.forEach(e,function(e,t){n.push({field:t,value:e})},n),n},n.parseArray=function(e){if(!e||!e.length)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t];if(r&&angular.isObject(r))for(var i in r)i=i.toLowerCase(),r.hasOwnProperty(i)&&-1==n.indexOf(i)&&n.push(i)}return{fields:n,array:e,isSimple:0==n.length}},n.resetInput=function(){n.jsonText=JSON.stringify(n.sample),n.parseObject()},n.parseObject=function(){if(c(),n.targetObj=null,n.jsonText){var e=r.defer();e.promise.then(function(e){n.errorMessage=null,n.jsonText&&(n.targetObj=e),a(function(){i(o,n)})},function(e){n.errorMessage=e}),a(function(){try{var t=angular.fromJson(n.jsonText);e.resolve(t)}catch(r){e.reject(r)}})}},n.editField=function(e,t){return n.editScope.editingField=e,n.editScope.editingItemIndex=t,!0},n.isEditingField=function(e,t){return n.editScope.editingField==e&&n.editScope.editingItemIndex==t},n.submitValue=function(e,n,t,r){return t?n[t]=e:-1!=r&&(n[r]=e),!0}}angular.module("jsonEditor",["angulartics","angulartics.google.analytics"]).factory("fieldService",n).factory("sampleData",t).directive("butCollapse",r).controller("RootObj",a)}();